---
permalink: /blog/llm-geocoding/
---
<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NJM0RV1MF0"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-NJM0RV1MF0');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/images/rocketship.jpg" type="image/jpeg">
    <title>Toying Around</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- PapaParse for CSV parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <style>
        #map {
            height: 600px;
            width: 100%;
            margin-top: 20px;
        }
        .legend {
            background-color: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
        }
        .legend-item {
            margin: 5px 0;
        }
        .color-box {
            display: inline-block;
            width: 15px;
            height: 15px;
            margin-right: 5px;
            border-radius: 50%;
        }
    </style>
</head>

<body>
    <header>
        <a href="https://toyi.ng">
            <img src="/images/paint_spaceship.png" alt="Spaceship" height="80">
        </a>
    </header>
    <h1>LLM Geocoding</h1>
    <p>I was playing around with Google's Geocoding API when I thought to plug in an address to o1 for shits and
        giggles. Imagine my surprise when it actually got it right down to the first 3 decimal places (precision of
        within hundreds of meters)! Considering the fact that it got in the near vicinity without any internet access at
        all, that's pretty impressive. Naturally, the next step was to host a battle royale with a bunch of other
        widely-used LLMs to see which one is best for this "offline" geocoding.

        I first created a dataset of 25 locations with the coordinates from Google Maps as the source of truth.

        Next, I chose 7 LLMs to compare [o1, claude-3.7-sonnet, deepseek_r1, deepseek v3, gemini-2.5-pro-experimental, llama_3_1_405B_instruct, llama_4_maverick_17B_128E_instruct].
    </p>
    <div id="map"></div>
    
    <script>
        // Initialize the map
        const map = L.map('map').setView([0, 0], 2);
        
        // Add OpenStreetMap tile layer
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);
        
        // Define colors for each source
        const colors = {
            'address_source_of_truth': 'black',
            'chatgpt_o1': 'blue',
            'claude_3_7_sonnet': 'green',
            'deepseek_r1': 'red',
            'deepseek_v3': 'purple',
            'gemini_2_5_pro_experimental': 'orange',
            'llama_3_1_405B_instruct': 'darkred',
            'llama_4_maverick_17B_128E_instruct': 'cadetblue'
        };
        
        // Create layer groups for each source
        const layers = {};
        Object.keys(colors).forEach(source => {
            layers[source] = L.layerGroup().addTo(map);
        });
        
        // Function to load and process CSV files
        async function loadCSVs() {
            const csvFiles = [
                'csv/address_source_of_truth.csv',
                'csv/chatgpt_o1.csv',
                'csv/claude_3_7_sonnet.csv',
                'csv/deepseek_r1.csv',
                'csv/deepseek_v3.csv',
                'csv/gemini_2_5_pro_experimental.csv',
                'csv/llama_3_1_405B_instruct.csv',
                'csv/llama_4_maverick_17B_128E_instruct.csv'
            ];
            
            const allLats = [];
            const allLons = [];
            
            for (const file of csvFiles) {
                const sourceName = file.replace('csv/', '').replace('.csv', '');
                
                try {
                    const response = await fetch(file);
                    const csvText = await response.text();
                    
                    Papa.parse(csvText, {
                        header: true,
                        skipEmptyLines: true,
                        complete: function(results) {
                            results.data.forEach(row => {
                                const lat = parseFloat(row.Latitude);
                                const lon = parseFloat(row.Longitude);
                                
                                if (!isNaN(lat) && !isNaN(lon)) {
                                    allLats.push(lat);
                                    allLons.push(lon);
                                    
                                    // Create popup content
                                    const popupContent = `
                                        <b>Source:</b> ${sourceName}<br>
                                        <b>Address:</b> ${row.Address}<br>
                                        <b>Coordinates:</b> ${lat}, ${lon}
                                    `;
                                    
                                    // Add marker to the appropriate layer
                                    L.circleMarker([lat, lon], {
                                        radius: 5,
                                        color: colors[sourceName],
                                        fillColor: colors[sourceName],
                                        fillOpacity: 0.7,
                                        weight: 1
                                    })
                                    .bindPopup(popupContent)
                                    .bindTooltip(`${sourceName}: ${row.Address}`)
                                    .addTo(layers[sourceName]);
                                }
                            });
                            
                            // After loading all data, center the map
                            if (allLats.length > 0 && allLons.length > 0) {
                                const centerLat = allLats.reduce((a, b) => a + b, 0) / allLats.length;
                                const centerLon = allLons.reduce((a, b) => a + b, 0) / allLons.length;
                                map.setView([centerLat, centerLon], 2);
                            }
                        }
                    });
                } catch (error) {
                    console.error(`Error loading ${file}:`, error);
                }
            }
        }
        
        // Create a legend
        const legend = L.control({position: 'bottomright'});
        
        legend.onAdd = function(map) {
            const div = L.DomUtil.create('div', 'legend');
            div.innerHTML = '<h4>Data Sources</h4>';
            
            Object.entries(colors).forEach(([source, color]) => {
                div.innerHTML += `
                    <div class="legend-item">
                        <span class="color-box" style="background-color: ${color}"></span>
                        ${source.replace(/_/g, ' ')}
                    </div>
                `;
            });
            
            return div;
        };
        
        legend.addTo(map);
        
        // Add layer control
        const overlays = {};
        Object.entries(layers).forEach(([name, layer]) => {
            overlays[name.replace(/_/g, ' ')] = layer;
        });
        
        L.control.layers(null, overlays, {collapsed: false}).addTo(map);
        
        // Load the data
        loadCSVs();
    </script>
</body>

</html>
